-- name: CreateVulnerability :one
INSERT INTO vulnerability (id, created_at, updated_at, name, risk, command, severity, steps_to_reproduce, power)
VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)
RETURNING *;

-- name: CreateVulnerabilityTag :one
INSERT INTO vulnerability_tag (id, vulnerability_id, tag_id)
VALUES ($1, $2, $3)
RETURNING *;

-- name: CreateVulnerabilityFuzzing :one
INSERT INTO vulnerability_fuzzing (id, vulnerability_id, fuzzing_id)
VALUES ($1, $2, $3)
RETURNING *;

-- name: GetVulnerabilityByID :one
SELECT *
FROM vulnerability
WHERE id = $1;

-- name: GetVulnerabilityTagByID :many
SELECT *
FROM vulnerability_tag
WHERE vulnerability_id = $1;

-- name: GetVulnerabilityFuzzingByID :many
SELECT *
FROM vulnerability_fuzzing
WHERE vulnerability_id = $1;

-- name: ListVulnerability :many
SELECT *
FROM vulnerability;

-- name: DeleteVulnerability :exec
DELETE
FROM vulnerability
WHERE id = $1;